In this implementation, make_parser is very similar to make_matcher. It goes through the grammar DFS to find each terminal in the fragment. It is different in that the return types for all the helper functions are different, and return the given tree instead. The problem right now is that it stops on any term that is a subset of the fragment. For example, if the fragment was ["$"; "1"; "++"], it would return a parse tree that would be for ["$"; "1"] only, because there was a term [N Lvalue] that completes it. Everything else works fine though. If I figure out the correct way to do it, I'll turn in that solution next. This is the best solution I have right now.